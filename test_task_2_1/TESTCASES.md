# Тест-кейсы для API микросервиса объявлений

## Версия 1

**ID:** TC_001

**Название:**
Успешное создание объявления

**Описание:**
Проверка, что объявление создаётся при корректном теле запроса

**Метод:** POST /api/1/item

**Шаги:**

1. Отправить POST-запрос c телом:

```json
{
  "sellerID": 123456,
  "name": "Test Item",
  "price": 999,
  "statistics": {
    "views": 0,
    "likes": 0,
    "contacts": 0
  }
}
```

**Ожидаемый результат:**

- 200 OK.
- Тело ответа содержит:

```json
{
    "status": "Сохранили объявление - {id}"
}
```

---

**ID:** TC_002

**Название:**
Cоздание объявления без обязательных полей

**Описание:**
Проверка поведения API при отсутствии обязательных полей в теле запроса (sellerID, name, price)

**Метод:** POST /api/1/item

**Шаги:**  

1. Отправить POST-запрос с телом:

```json
{
  "statistics": {
    "views": 0,
    "likes": 0,
    "contacts": 0
  }
}
```

**Ожидаемый результат:**

- 400 Bad Request.
- Тело ответа содержит объект с общей ошибкой и деталями по каждому обязательному полю

``` json
{
  "result": {
    "message": "ошибка валидации",
    "messages": {
      "sellerID": "обязательное поле",
      "name": "обязательное поле",
      "price": "обязательное поле"
    }
  },
  "status": "400"
}

```

---

**ID:** TC_003

**Название:**
Cоздание объявления c пустым телом

**Описание:**
Проверка поведения API при отправке запроса с пустым телом

**Метод:** POST /api/1/item

**Шаги:**  

1. Отправить POST-запрос на /api/1/item с телом:

```json
{
}
```

**Ожидаемый результат:**

- 400 Bad Request.
- Тело ответа содержит:

``` json
{
  "result": {
    "message": "ошибка валидации",
    "messages": {
      "sellerID": "обязательное поле",
      "name": "обязательное поле",
      "price": "обязательное поле"
    }
  },
  "status": "400"
}

```

---

**ID:** TC_004

**Название:**  
Получение объявления по валидному UUID

**Метод:** GET /api/1/item/{id}

**Предусловия:** Объявление создано (TC_001)

**Шаги:**  

1. Отправить GET-запрос с UUID

**Ожидаемый результат:**

- 200 OK
- JSON с id, name, price, sellerId, statistics, createdAt

---

**ID:** TC_005

**Название:** Получение объявления с несуществующим ID

**Описание:** Проверка, что сервер корректно обрабатывает запрос на получение несуществующего объекта

**Метод:** GET /api/1/item/:id

**Предусловия:** ID отсутствует в системе

**Шаги:**

1. Отправить GET-запрос

**Ожидаемый результат:**

- 404 Not Found
- Тело ответа содержит:

``` json
{
  "result": {
    "message": "item {id} not found",
    "messages": null
  },
  "status": "404"
}
```

---

**ID:** TC_006

**Название:** Получение объявления без ID

**Описание:** Проверка, что сервер корректно обрабатывает отсутствие обязательного path-параметра

**Шаги:**

1. Отправить GET-запрос на /api/1/item/ без указания ID

**Ожидаемый результат:**

- 404 Not Found
- Тело ответа содержит:

```json
{
    "message": "route /api/1/item/ not found",
    "code": 404
}
```

---

**ID:** TC_007

**Название:** Получение всех объявлений по sellerID

**Описание:** Проверка выдачи всех объявлений пользователя

**Метод:** GET /api/1/:sellerID/item

**Предусловия:** У sellerID есть созданные объявления (TC-001)

**Шаги:**

1. Отправить GET-запрос

**Ожидаемый результат:**

- 200 OK
- Массив JSON объектов с полями id, name, price, sellerId, statistics, createdAt

---

**ID:** TC_008

**Название:** Получение объявления с несуществующим sellerID

**Метод:** GET /api/1/:sellerID/item

**Предусловия:** sellerID отсутствует в системе

**Шаги:**

1. Отправить GET-запрос

**Ожидаемый результат:**

- 400 Bad Request
- Тело ответа содержит:

```json
{
    "result": {
        "message": "передан некорректный идентификатор продавца",
        "messages": {}
    },
    "status": "400"
}
```

---

**ID:** TC_009

**Название:** Получение статистики с валидным ID объявления

**Метод:** GET /api/1/statistic/:id

**Предусловия:** ID существует в системе (TC_001)

**Шаги:**

1. Отправить GET-запрос

**Ожидаемый результат:**

- 200 OK
- JSON объект с полями contacts, likes, viewCount

---

**ID:** TC_010

**Название:** Получение статистики с несуществующим ID объявления

**Описание:**
Проверка обработки запроса на получение статистики по ID, которого нет в системе

**Метод:** GET /api/1/statistic/:id

**Предусловия:** ID отсутствует в системе

**Шаги:**

1. Отправить GET-запрос

**Ожидаемый результат:**

- 404 Not Found

- Тело ответа содержит:

```json
{
  "result": {
    "message": "statistic {id} not found",
    "messages": null
  },
  "status": "404"
}
```

---

**ID:** TC_011

**Название:** Получение статистики без указания ID объявления

**Описание:** Проверка, что сервер корректно обрабатывает отсутствие обязательного path-параметра

**Шаги:**

1. Отправить GET-запрос на /api/1/statistic/ без указания ID

**Ожидаемый результат:**

- 404 Not Found
- Тело ответа содержит:

```json
{
    "message": "route /api/1/statistic/ not found",
    "code": 404
}
```

---

## Версия 2

**ID:** TC_012

**Название:** Получение статистики по ID объявления через API v2

**Описание:** Проверка аналогичной статистики через версию 2

**Метод:** GET /api/2/statistic/:id

**Предусловия:** Объявление было создано (TC_001)

**Шаги:**  

1. Отправить GET-запрос

**Ожидаемый результат:**

- 200 OK
- JSON с полями contacts, likes, viewCount

---

**ID:** TC_013

**Название:**
Получение статистики с несуществующим ID объявления

**Описание:**
Проверка обработки запроса в версии 2 API по ID, которого нет

**Метод:** GET /api/2/statistic/:id

**Предусловия:** ID отсутствует в системе

**Шаги:**

1. Отправить GET-запрос

**Ожидаемый результат:**

- 404 Not Found

- Тело ответа содержит сообщение об ошибке:

```json
{
  "result": {
    "message": "statistic {id} not found",
    "messages": null
  },
  "status": "404"
}

```

---

**ID:** TC_014

**Название:**
Успешное удаление объявления

**Описание:**
Проверка корректного удаления существующего объявления

**Метод:** DELETE /api/2/item/:id

**Предусловия:** Объявление было создано (TC-001)

**Шаги:**  

1. Отправить DELETE-запрос

**Ожидаемый результат:**

- 200 OK
- Тело: { "status": "deleted", "id": "{uuid}" }

---

**ID:** TC_016

**Название:**
Удаление объявления с несуществующим ID

**Описание:**
Проверка обработки удаления по ID, которого нет в системе

**Метод:** DELETE /api/2/item/:id

**Предусловия:** Объявление с указанным ID отсутствует

**Шаги:**  

1. Отправить DELETE-запрос

**Ожидаемый результат:**

- 404 Not Found

- Тело ответа содержит:

``` json
{
  "result": {
    "message": "объявление не найдено",
    "messages": null
  },
  "status": "404"
}

```
