# BUGS.md  

## Баг-репорты по API микросервиса объявлений  

**ID:** BUG-001

**Название:**
Некорректная обработка POST-запроса без обязательных полей

**Описание:**
При отправке запроса без обязательных полей sellerID, name и price, API не выдает ошибку, а возвращает 200 OK.

**Модуль:** POST /api/1/item

**Шаги для воспроизведения:**

1. Отправить POST-запрос с телом:

```json
{
  "statistics": {
    "views": 0,
    "likes": 0,
    "contacts": 0
  }
}
```

**Ожидаемый результат:**

- 400
- Тело ответа содержит сообщение: "Не указаны обязательные поля: sellerID, name, price"

**Фактический результат:**

- 200 OK
- Тело ответа содрежит:

``` json
{
    "status": "Сохранили объявление - {id}"
}
```

**Критичность:** Medium

**Приоритет:** High

---

**ID:** BUG-002

**Название:**
Некорректная обработка POST-запроса с пустым телом

**Описание:**
При отправке пустого тела запроса API не выдает ошибку, а возвращает 200 OK

**Модуль:** POST /api/1/item

**Шаги для воспроизведения:**

1. Отправить POST-запрос с пустым телом:

```json
{
}
```

**Ожидаемый результат:**

- Статус 400
- Сообщение об ошибке: "Пустое тело запроса" или "Не переданы обязательные поля"

**Фактический результат:**

- 200 OK
- Тело ответа содрежит:

``` json
{
    "status": "Сохранили объявление - {id}"
}
```

**Критичность:** Medium

**Приоритет:** Medium

---

**ID:** BUG-003

**Название:**
Несоответствие HTTP-статуса и значения в теле при отсутствии ID

**Описание:**
Сервер возвращает 404 Not Found, но в теле ответа указан код ошибки 400.

**Модуль:** GET /api/1/item/

**Шаги для воспроизведения:**

1. Отправить GET-запрос

**Ожидаемый результат:**

- 404 Not Found
- Тело ответа содержит:

```json
{
    "message": "route /api/1/item/ not found",
    "code": 404
}
```

**Фактический результат:**

- 404 Not Found
- Тело ответа содержит:

```json
{
  "message": "route /api/1/item/ not found",
  "code": 400
}
```

**Критичность:** Medium

**Приоритет:** High

---

**ID:** BUG-004

**Название:**
Несоответствие HTTP-статуса и значения в теле при отсутствии ID

**Описание:**
Сервер возвращает 404 Not Found, но в теле ответа указан код ошибки 400.

**Модуль:** GET /api/1/statistic/

**Шаги для воспроизведения:**

1. Отправить GET-запрос

**Ожидаемый результат:**

- 404 Not Found
- Тело ответа содержит:

```json
{
    "message": "route /api/1/statistic/ not found",
    "code": 404
}
```

**Фактический результат:**

- 404 Not Found
- Тело ответа содержит:

```json
{
    "message": "route /api/1/statistic/ not found",
    "code": 400
}
```

**Критичность:** Low

**Приоритет:** Medium

---

**ID:** BUG-005

**Название:**
Неверный ответ при получении статистики с несуществующем ID объявления (v2)

**Описание:**
При получении статистики с несуществующем ID, API возвращает статус 200 OK

**Модуль:** GET /api/2/statistic/:id

**Предусловие:**
ID отсутствует в системе

**Шаги для воспроизведения:**

1. Отправить GET-запрос

**Ожидаемый результат:**

- 404 Not Found
- Тело ответа содержит:

```json
{
    "message": "statistic {id} not found",
    "code": 404
}
```

**Фактический результат:**

- 200 OK

**Критичность:** Medium

**Приоритет:** High

---

**ID:** BUG-006

**Название:**
Пустое сообщение в ответе при успешном удалении объявления

**Описание:**
API возвращает 200 OK, но в ответе отсутствует подтверждение действия. Стоит в теле ответа вернуть сообщение, подтверждающее выполненное действие.

**Модуль:** DELETE /api/2/item/:id

**Предусловия:** Объявление было создано (TC-001)

**Шаги для воспроизведения:**

1. Отправить DELETE-запрос

**Ожидаемый результат:**

- 200 OK
- Тело: { "status": "deleted", "id": "{uuid}" }

**Фактический результат:**

- 200 OK

**Критичность:** Low

**Приоритет:** Medium

---

**ID:** BUG-007

**Название:**
Ошибка в статусе тела при удалении несуществующего объявления

**Описание:**
API возвращает 404, но в теле "status": 500, сообщение пустое — это несоответствие.

**Модуль:** DELETE /api/2/item/:id

**Предусловия:** Объявление с указанным ID отсутствует

**Шаги для воспроизведения:**

1. Отправить DELETE-запрос

**Ожидаемый результат:**

- 404 Not Found
- Тело ответа содержит:

``` json
{
  "result": {
    "message": "item {id} not found",
    "messages": null
  },
  "status": 404
}

```

**Фактический результат:**

- 404 Not Found
- Тело ответа содержит:

``` json
{
  "result": {
    "message": "",
    "messages": null
  },
  "status": 500
}

```

**Критичность:** Medium

**Приоритет:** Medium

---

**ID:** BUG-008

**Название:**
Ошибки при запросе на получение статистики с некорректным ID (null) через API v2

**Описание:**
API возвращает статус 200 ОК и пустое тело.

**Модуль:** GET /api/2/statistic/null

**Предусловия:** Объявление с указанным ID отсутствует

**Шаги для воспроизведения:**

1. Отправить GET-запрос

**Ожидаемый результат:**

- 404 Not Found
- Тело ответа содержит:

``` json
{
    "result": {
        "message": "передан некорректный идентификатор объявления",
        "messages": {}
    },
    "status": "400"
}
```

**Фактический результат:**

- 200 OK

**Критичность:** Low

**Приоритет:** Low

---

**ID:** BR-009

**Название:**
Некорректный тип ответа при получении объявления по ID

**Описание:**
Ручка GET /api/1/item/:id возвращает массив с одним объектом вместо объекта. Это нарушает контракт API и затрудняет клиентскую обработку.

**Метод:** GET /api/1/item/:id

**Предусловия:** Объявление было создано (TC-001)

**Ожидаемый результат:**
Ответ — объект с полями id, name, price, sellerId, statistics, createdAt

**Фактический результат:**
Ответ — массив с одним объектом

**Приоритет:** High

**Критичность:** Medium

---

**ID:** BR-010

**Название:**
Некорректный тип ответа при получении статистики объявления по ID

**Описание:**
Ручка GET /api/1/statistic/:id возвращает массив с одним объектом вместо объекта. Это нарушает контракт API и затрудняет клиентскую обработку.

**Метод:** GET /api/1/statistic/:id

**Предусловия:** Объявление было создано (TC-001)

**Ожидаемый результат:**
Ответ — объект с полями contacts, likes, viewCount

**Фактический результат:**
Ответ — массив с одним объектом

**Приоритет:** High

**Критичность:** Medium

---

**ID:** BR-011

**Название:**
Некорректный тип ответа при получении статистики объявления по ID через API v2

**Описание:**
Ручка GET /api/2/statistic/:id возвращает массив с одним объектом вместо объекта. Это нарушает контракт API и затрудняет клиентскую обработку.

**Метод:** GET /api/2/statistic/:id

**Предусловия:** Объявление было создано (TC-001)

**Ожидаемый результат:**
Ответ — объект с полями contacts, likes, viewCount

**Фактический результат:**
Ответ — массив с одним объектом

**Приоритет:** High

**Критичность:** Medium
